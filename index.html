<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no" />
<title>Robot Hand: Final Corrected Grip</title>
<style>
  html, body {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    background: #111;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-family: sans-serif;
  }

  /* UI Controls */
  #controls {
    position: fixed;
    bottom: 30px;
    display: flex;
    gap: 20px;
    z-index: 100;
  }
  button {
    background: #222;
    color: #ccc;
    border: 1px solid #444;
    padding: 12px 28px;
    border-radius: 30px;
    font-size: 14px;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: bold;
  }
  button:hover { background: #444; color: #fff; }
  button.active { 
    background: #f0c040; 
    color: #000; 
    border-color: #f0c040; 
    box-shadow: 0 0 15px rgba(240, 192, 64, 0.4);
  }

  /* SVG Styling */
  svg {
    height: 90vh;
    width: 100%;
    max-width: 600px;
  }

  /* --- Parts Styles --- */
  .skin { fill: #e6e2d3; stroke: #1a1a1a; stroke-width: 2.5px; }
  .dark-part { fill: #555; stroke: #1a1a1a; stroke-width: 2px; }
  .joint { fill: #333; stroke: #111; stroke-width: 2px; }
  .nail { fill: #ddd; stroke: #1a1a1a; stroke-width: 1px; }
  
  /* The Phone */
  .phone {
    fill: #4da6ff;
    stroke: #111;
    stroke-width: 3px;
    rx: 10; ry: 10;
    opacity: 0;
    transition: opacity 0.4s ease 0.2s;
  }

  /* --- Animations (CSS Transforms) --- */
  
  /* 1. 全体の回転 (手のひらと指) */
  #hand-wrapper {
    transform-origin: 200px 480px; /* 手首のすぐ上あたりを軸に */
    transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  
  /* HOLD状態: 小指側（右下方向）に回転 (画像の状態に合わせる) */
  .is-holding #hand-wrapper {
    transform: rotate(-15deg); /* わずかに小指側に傾ける */
  }

  /* 2. 指の動き */
  .finger-base, .finger-tip, #thumb-group, .thumb-tip {
    transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1);
  }

  /* === HOLD State Animations === */
  .is-holding .phone { opacity: 1; }

  /* 4本の指の動き: ケータイを包み込む（画像に合わせて、根元を大きく曲げる） */
  
  /* 小指 */
  .is-holding #little-base { transform: rotate(20deg); } 
  .is-holding #little-tip  { transform: rotate(-85deg); } /* 指先は深く曲がる */

  /* 薬指 */
  .is-holding #ring-base   { transform: rotate(10deg); }
  .is-holding #ring-tip    { transform: rotate(-85deg); }

  /* 中指 */
  .is-holding #middle-base { transform: rotate(0deg); }
  .is-holding #middle-tip  { transform: rotate(-80deg); }

  /* 人差し指 */
  .is-holding #index-base  { transform: rotate(-10deg); }
  .is-holding #index-tip   { transform: rotate(-80deg); }

  /* 親指 (Thumb) - ケータイを支える動き */
  .is-holding #thumb-group { 
    transform: translate(0, -10px) rotate(-40deg); /* ケータイの側面に来るように移動＆回転 */
  }
  .is-holding .thumb-tip { 
    transform: rotate(15deg); /* 親指の先を反らせてケータイに当てる */
  }
  
  /* 指先の追従用スタイル */
  .is-holding .finger-base-tracker:nth-child(1) { transform: rotate(20deg); } /* 小指 */
  .is-holding .finger-base-tracker:nth-child(2) { transform: rotate(10deg); } /* 薬指 */
  .is-holding .finger-base-tracker:nth-child(3) { transform: rotate(0deg); } /* 中指 */
  .is-holding .finger-base-tracker:nth-child(4) { transform: rotate(-10deg); } /* 人差し指 */
  .finger-base-tracker { transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1); }

</style>
</head>
<body>

<div id="controls">
  <button id="btnRelax" class="active" onclick="setState('relax')">RELAX</button>
  <button id="btnHold" onclick="setState('hold')">HOLD</button>
</div>

<svg viewBox="0 0 400 800" id="canvas">
  
  <g id="wrist-fixed">
    <path class="dark-part" d="M140 540 L140 680 L260 680 L260 540 Z" />
    <ellipse class="joint" cx="200" cy="540" rx="65" ry="22" />
  </g>

  <g id="hand-wrapper">

    <g id="layer-back">
      <path class="skin" d="M125 380 L110 460 Q140 560 200 560 Q260 560 290 460 L315 420 L275 380 L225 360 L175 360 Z" />
      <path class="dark-part" opacity="0.6" d="M150 420 Q200 450 250 420 L240 500 Q200 520 160 500 Z" />
      
      <g id="little-base" class="finger-base" style="transform-origin: 130px 380px;">
        <rect class="skin" x="118" y="290" width="24" height="90" rx="10" />
        <circle class="joint" cx="130" cy="380" r="14" />
      </g>
      <g id="ring-base" class="finger-base" style="transform-origin: 175px 360px;">
        <rect class="skin" x="163" y="260" width="24" height="100" rx="10" />
        <circle class="joint" cx="175" cy="360" r="14" />
      </g>
      <g id="middle-base" class="finger-base" style="transform-origin: 225px 360px;">
        <rect class="skin" x="213" y="255" width="24" height="105" rx="10" />
        <circle class="joint" cx="225" cy="360" r="14" />
      </g>
      <g id="index-base" class="finger-base" style="transform-origin: 275px 380px;">
        <rect class="skin" x="263" y="280" width="24" height="100" rx="10" />
        <circle class="joint" cx="275" cy="380" r="14" />
      </g>
    </g>

    <rect id="phone" class="phone" x="145" y="190" width="110" height="260" />

    <g id="layer-front">
      <g class="finger-base-tracker" style="transform-origin: 130px 380px;">
         <g id="little-tip" class="finger-tip" style="transform-origin: 130px 290px;">
          <rect class="skin" x="118" y="200" width="24" height="100" rx="10" />
          <path class="nail" d="M122 205 Q130 195 138 205 L138 220 L122 220 Z" />
          <circle class="joint" cx="130" cy="290" r="12" />
        </g>
      </g>
      <g class="finger-base-tracker" style="transform-origin: 175px 360px;">
        <g id="ring-tip" class="finger-tip" style="transform-origin: 175px 260px;">
          <rect class="skin" x="163" y="150" width="24" height="120" rx="10" />
          <path class="nail" d="M167 155 Q175 145 183 155 L183 170 L167 170 Z" />
          <circle class="joint" cx="175" cy="260" r="12" />
        </g>
      </g>
      <g class="finger-base-tracker" style="transform-origin: 225px 360px;">
        <g id="middle-tip" class="finger-tip" style="transform-origin: 225px 255px;">
          <rect class="skin" x="213" y="140" width="24" height="125" rx="10" />
          <path class="nail" d="M217 145 Q225 135 233 145 L233 160 L217 160 Z" />
          <circle class="joint" cx="225" cy="255" r="12" />
        </g>
      </g>
      <g class="finger-base-tracker" style="transform-origin: 275px 380px;">
        <g id="index-tip" class="finger-tip" style="transform-origin: 275px 280px;">
          <rect class="skin" x="263" y="170" width="24" height="120" rx="10" />
          <path class="nail" d="M267 175 Q275 165 283 175 L283 190 L267 190 Z" />
          <circle class="joint" cx="275" cy="280" r="12" />
        </g>
      </g>

      <g id="thumb-group" style="transform-origin: 320px 480px;">
        <ellipse class="skin" cx="320" cy="480" rx="28" ry="38" transform="rotate(-20 320 480)"/>
        <rect class="skin" x="305" y="410" width="30" height="70" rx="12" transform="rotate(-15 320 480)" />
        <g class="thumb-tip" style="transform-origin: 329 410;">
          <rect class="skin" x="315" y="340" width="28" height="70" rx="10" transform="rotate(-15 329 410)" />
          <path class="nail" d="M325 345 Q335 335 345 350 L340 360 L320 355 Z" transform="rotate(-15 329 410)"/>
          <circle class="joint" cx="329" cy="410" r="13" />
        </g>
      </g>
    </g>
  </g>
</svg>

<script>
  function setState(state) {
    const canvas = document.getElementById('canvas');
    const btnRelax = document.getElementById('btnRelax');
    const btnHold = document.getElementById('btnHold');
    
    if (state === 'hold') {
      canvas.classList.add('is-holding');
      btnHold.classList.add('active');
      btnRelax.classList.remove('active');
    } else {
      canvas.classList.remove('is-holding');
      btnRelax.classList.add('active');
      btnHold.classList.remove('active');
    }
  }
</script>

</body>
</html>

